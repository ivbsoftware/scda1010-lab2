---
title: "R Notebook"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(ggplot2)
library(reshape2)
library(plyr)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.


Reading red wines dataset

```{r}
library(readr)
wines_red_data <- 
  read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv", sep=";")

head(wines_red_data)
str(wines_red_data)
```


```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}
library(xtable)
options(xtable.floating = TRUE)
options(xtable.timestamp = "")
options(xtable.comment = FALSE)

dh.rescale <- xtable(head(wines_red_data, n=10), 
  caption = "\\tt Red Wines Quality Dataset (head)", label = "table:dhead10")

print(dh.rescale, scalebox=.75)
```

```
For more information, read [Cortez et al., 2009]. 
Input variables (based on physicochemical tests): 

1 - fixed acidity 
2 - volatile acidity 
3 - citric acid 
4 - residual sugar 
5 - chlorides 
6 - free sulfur dioxide 
7 - total sulfur dioxide 
8 - density 
9 - pH 
10 - sulphates 
11 - alcohol 
Output variable (based on sensory data): 
12 - quality (score between 0 and 10)
```

Plot pairwise scatter plots in RStudio and inspect the result for relationships between the independent variable and the numerical dependent variables.

```{r pair_rw, fig.pos = 'h', fig.height=26, fig.width=20, fig.align="center", fig.cap="Red Wines - relationships between variables"}
attach(wines_red_data)
panel.points<-function(x,y){points(x,y,cex=.25)}
pairs(~quality + 
        fixed.acidity + volatile.acidity + citric.acid + 
        residual.sugar + chlorides + free.sulfur.dioxide + 
        total.sulfur.dioxide + density + pH + sulphates + alcohol,
        upper.panel=panel.points,lower.panel=panel.points)
```

